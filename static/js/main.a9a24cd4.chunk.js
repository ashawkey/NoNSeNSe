(this.webpackJsonpnonsense=this.webpackJsonpnonsense||[]).push([[0],{28:function(e,t,n){},367:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(41),l=n.n(c),o=(n(58),n(7)),u=n(1),s=n(42),i=n.n(s),m=(n(28),n(3)),f="https://www.hawia.xyz/api/nonsense";n(63);function d(e){var t=new Date(1e3*e),n=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),c=t.getHours(),l=t.getMinutes();return n+"-"+a+"-"+r+" "+(c<=9?"0"+c:c)+":"+(l<=9?"0"+l:l)}function v(e,t){var n="000000000"+e.toString();return n.substr(n.length-t)}function E(){return localStorage.nonsense_token||"nonsense"}function b(e){return r.a.createElement("div",{className:"flow-item"},r.a.createElement(o.b,{to:"/edit/"+e.value[0]},r.a.createElement("div",{className:"date"},r.a.createElement("span",null," ",v(e.value[0],6)," "),r.a.createElement("span",null," "," "+d(e.value[2])," "),r.a.createElement("span",null," "," "+d(e.value[1])," ")),r.a.createElement("hr",null),r.a.createElement("div",{className:"content"},(t=e.value[3],n=300,t.length>n?t.substring(0,n)+"......":t))));var t,n}var h=function(e){return r.a.createElement("div",{className:"flow"},e.meta.map((function(e,t){return r.a.createElement(b,{value:e,key:t})})))};var p=function(){var e=Object(a.useState)([]),t=Object(m.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(!0),o=Object(m.a)(l,2),u=o[0],s=o[1];return Object(a.useEffect)((function(){fetch(f+"/meta?token="+E()).then((function(e){return e.json()})).then((function(e){c(e),s(!1)}))}),[]),u?r.a.createElement("div",{className:"loading"}," \u262a "):r.a.createElement("div",{className:"Home"},r.a.createElement(h,{meta:n}))};n(67);var g=function(){var e=Object(a.useState)(""),t=Object(m.a)(e,2),n=t[0],c=t[1],l=Object(u.g)();return Object(a.useEffect)((function(){c(localStorage.nonsense_token||"")}),[]),r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),""!==n?(localStorage.nonsense_token=n,alert("Hello, "+n+"!")):(localStorage.nonsense_token="nonsense",alert("Hello, nonsense!")),l.push("/")},className:"login-form"},r.a.createElement("div",{className:"title"}," Make any sense ? "),r.a.createElement("input",{type:"text",value:n,placeholder:"nonsense",maxLength:"99",onChange:function(e){c(e.target.value)}})))},j=(n(68),n(14)),O=n(44),w=n(45),N=n(52),S=n(51),y=n(46),k=n.n(y),D=n(17),x=n.n(D),C=n(47),P=n.n(C),M=n(371),F=n(370),H=function(e){Object(N.a)(n,e);var t=Object(S.a)(n);function n(){return Object(O.a)(this,n),t.apply(this,arguments)}return Object(w.a)(n,[{key:"render",value:function(){var e=this.props,t=e.language,n=e.value;return r.a.createElement(M.a,{language:t,style:F.a},n)}}]),n}(a.PureComponent);H.defaultProps={language:null};var _=function(e){var t=Object(j.a)(Object(j.a)({},e),{},{plugins:[P.a],renderers:Object(j.a)(Object(j.a)({},e.renderers),{},{code:H,math:function(e){return r.a.createElement(x.a.Node,{formula:e.value})},inlineMath:function(e){return r.a.createElement(x.a.Node,{inline:!0,formula:e.value})}})});return r.a.createElement(x.a.Provider,{input:"tex"},r.a.createElement(k.a,t))};var I=function(){var e=Object(a.useState)(""),t=Object(m.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(0),o=Object(m.a)(l,2),s=(o[0],o[1]),i=Object(a.useState)(0),b=Object(m.a)(i,2),h=b[0],p=b[1],g=Object(a.useState)(!0),j=Object(m.a)(g,2),O=j[0],w=j[1],N=Object(a.useState)("saved"),S=Object(m.a)(N,2),y=S[0],k=S[1],D=Object(a.useState)(0),x=Object(m.a)(D,2),C=x[0],P=x[1],M=Object(a.useState)("-1"),F=Object(m.a)(M,2),H=F[0],I=F[1],L=Object(u.g)(),T=Object(u.h)().nid;function A(e){if("failed"===y||"unsaved"===y||"saving"===y)return e.preventDefault(),e.returnValue="Draft unsaved"}function J(){if("unsaved"===y)if(k("saving"),"-1"===H){var e=new FormData;e.append("token",E()),e.append("body",n),e.append("state",C),fetch(f+"/post",{method:"POST",body:e}).then((function(e){return e.json()})).catch((function(e){k("failed"),console.error("Post error: ",e)})).then((function(e){I(e.nid.toString()),k("saved")}))}else{var t=new FormData;t.append("nid",H),t.append("body",n),t.append("state",C),fetch(f+"/update",{method:"POST",body:t}).then((function(e){return e.json()})).catch((function(e){k("failed"),console.error("Update error: ",e)})).then((function(e){k("saved")}))}}function U(e){e.preventDefault(),c(e.target.value),k("unsaved")}function z(e){9===e.keyCode&&(e.preventDefault(),c(n.substring(0,e.target.selectionStart)+"    "+n.substring(e.target.selectionEnd)))}return Object(a.useEffect)((function(){"-1"===T?(I(T),s(Date.now()/1e3),p(Date.now()/1e3),c(""),w(!1)):(I(T),fetch(f+"/get?nid="+T).then((function(e){return e.json()})).then((function(e){e.success&&(s(e.content[0]),p(e.content[1]),c(e.content[2]),P(e.content[3]),w(!1))})))}),[T]),Object(a.useEffect)((function(){var e=setInterval(J,1e3);return function(){clearInterval(e)}})),Object(a.useEffect)((function(){return window.addEventListener("beforeunload",A),function(){window.removeEventListener("beforeunload",A)}})),O?r.a.createElement("div",{className:"loading"}," \u262a "):r.a.createElement("div",{className:"editor"},r.a.createElement("div",{className:"date"},"| ",r.a.createElement("span",null," ","-1"===H?"new":v(H,6)," "),"| ",r.a.createElement("span",null," ",d(h)," "),"| ",r.a.createElement("span",{onClick:function(e){e.preventDefault(),P(1-C),k("unsaved")},className:"state-button"}," ",function(e){return 0===e?"edit":1===e?"view":"error"}(C)," "),"| ",r.a.createElement("span",{onClick:function(e){if(e.preventDefault(),window.confirm("Are you sure to delete?")){var t=new FormData;t.append("nid",H),fetch(f+"/delete",{method:"POST",body:t}).then((function(e){return e.json()})).then((function(e){L.push("/")}))}},className:"delete-button"}," delete "),"| ",r.a.createElement("span",null," ",function(e){return"failed"===e?r.a.createElement("span",{style:{color:"red"}}," failed "):"saved"===e?r.a.createElement("span",{style:{color:"green"}}," saved "):e}(y)," ")," |"),function(e){return 0===e?r.a.createElement("textarea",{onKeyDown:z,onChange:U,value:n}):1===e?r.a.createElement(_,{className:"markdown",source:n}):"error"}(C),r.a.createElement(u.a,{message:"Draft unsaved, are you sure to leave?",when:"failed"===y||"unsaved"===y||"saving"===y}))};var L=function(){var e=Object(u.g)(),t=Object(a.useState)(""),n=Object(m.a)(t,2),c=n[0],l=n[1];return r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),""!==c&&(e.push("/search/"+c),l(""))}},r.a.createElement("input",{type:"text",value:c,placeholder:"Search",onChange:function(e){l(e.target.value)}}))};var T=function(){var e=Object(u.h)().keyword,t=Object(a.useState)([]),n=Object(m.a)(t,2),c=n[0],l=n[1];return Object(a.useEffect)((function(){fetch(f+"/search?keyword="+e+"&token="+E()).then((function(e){return e.json()})).then((function(e){l(e)}))}),[e]),r.a.createElement("div",{className:"search-results"},r.a.createElement(h,{meta:c}))};function A(){return r.a.createElement("div",{className:"no-match"},r.a.createElement("p",null," No match! "))}var J=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(o.a,null,r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"title"}," ",r.a.createElement(o.b,{to:"/"}," NoNSeNSe ")," "),r.a.createElement("div",{className:"new-button"}," ",r.a.createElement(o.b,{to:"/edit/-1"}," \u271b ")," "),r.a.createElement("div",{className:"login-button"}," ",r.a.createElement(o.b,{to:"/login"}," \u2756 ")," "),r.a.createElement("div",{className:"search-bar"}," ",r.a.createElement(L,null)," ")),r.a.createElement("div",{className:"content"},r.a.createElement("hr",{className:"fancy-line"}),r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/login"},r.a.createElement(g,null)),r.a.createElement(u.b,{exact:!0,path:"/"},r.a.createElement(p,null)),r.a.createElement(u.b,{path:"/search/:keyword"},r.a.createElement(T,null)),r.a.createElement(u.b,{path:"/edit/:nid"},r.a.createElement(I,null)),r.a.createElement(u.b,{path:"*"},r.a.createElement(A,null))),r.a.createElement("hr",{className:"fancy-line"})),r.a.createElement(i.a,{showUnder:160},r.a.createElement("span",{className:"up-arrow"}," \u2bad ")),r.a.createElement("div",{className:"footer"},"@ ",r.a.createElement("a",{href:"https://github.com/ashawkey"}," hawkey "))))};l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J,null)),document.getElementById("root"))},53:function(e,t,n){e.exports=n(367)},58:function(e,t,n){},63:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){}},[[53,1,2]]]);
//# sourceMappingURL=main.a9a24cd4.chunk.js.map