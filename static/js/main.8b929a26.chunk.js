(this.webpackJsonpnonsense=this.webpackJsonpnonsense||[]).push([[0],{31:function(e,t,n){},384:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(48),l=n.n(c),o=(n(67),n(7)),u=n(1),s=n(49),i=n.n(s),m=(n(31),n(3)),f=n(50),d=n.n(f),v="https://www.hawia.xyz/api/nonsense";n(73);function h(e){var t=new Date(1e3*e),n=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),c=t.getHours(),l=t.getMinutes();return n+"-"+a+"-"+r+" "+(c<=9?"0"+c:c)+":"+(l<=9?"0"+l:l)}function E(e,t){var n="000000000"+e.toString();return n.substr(n.length-t)}function b(){return localStorage.nonsense_token||"nonsense"}function p(e){return r.a.createElement("div",{className:"flow-item"},r.a.createElement(o.b,{to:"/edit/"+e.value[0]},r.a.createElement("div",{className:"date"},r.a.createElement("span",null," ",E(e.value[0],6)," "),r.a.createElement("span",null," "," "+h(e.value[2])," "),r.a.createElement("span",null," "," "+h(e.value[1])," ")),r.a.createElement("hr",null),r.a.createElement("div",{className:"content"},(t=e.value[3],n=300,t.length>n?t.substring(0,n)+"......":t))));var t,n}var g=function(e){return r.a.createElement("div",{className:"flow"},e.items.map((function(e,t){return r.a.createElement(p,{value:e,key:t})})))};var j=function(){var e=Object(a.useState)([]),t=Object(m.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(!0),o=Object(m.a)(l,2),u=o[0],s=o[1],i=r.a.createElement("div",{className:"loading",key:0}," \u262a ");return r.a.createElement("div",{className:"Home"},r.a.createElement(d.a,{pageStart:0,loadMore:function(e){fetch(v+"/meta?token="+b()+"&page="+e).then((function(e){return e.json()})).then((function(e){c(n.concat(e.meta)),s(e.hasMore)}))},hasMore:u,loader:i},r.a.createElement(g,{items:n})))};n(76);var O=function(){var e=Object(a.useState)(""),t=Object(m.a)(e,2),n=t[0],c=t[1],l=Object(u.g)();return Object(a.useEffect)((function(){c(localStorage.nonsense_token||"")}),[]),r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),""!==n?(localStorage.nonsense_token=n,alert("Hello, "+n+"!")):(localStorage.nonsense_token="nonsense",alert("Hello, nonsense!")),l.push("/")},className:"login-form"},r.a.createElement("div",{className:"title"}," Make any sense ? "),r.a.createElement("input",{type:"text",value:n,placeholder:"nonsense",maxLength:"99",onChange:function(e){c(e.target.value)}})))},w=(n(77),n(15)),S=n(52),N=n(53),y=n(61),k=n(60),D=n(54),x=n.n(D),M=n(20),C=n.n(M),P=n(55),H=n.n(P),L=n(388),A=n(387),F=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(S.a)(this,n),t.apply(this,arguments)}return Object(N.a)(n,[{key:"render",value:function(){var e=this.props,t=e.language,n=e.value;return r.a.createElement(L.a,{language:t,style:A.a},n)}}]),n}(a.PureComponent);F.defaultProps={language:null};var _=function(e){var t=Object(w.a)(Object(w.a)({},e),{},{plugins:[H.a],renderers:Object(w.a)(Object(w.a)({},e.renderers),{},{code:F,math:function(e){return r.a.createElement(C.a.Node,{formula:e.value})},inlineMath:function(e){return r.a.createElement(C.a.Node,{inline:!0,formula:e.value})}})});return r.a.createElement(C.a.Provider,{input:"tex"},r.a.createElement(x.a,t))},z=n(59),I=n.n(z);n(381),n(382),n(383);var T=function(){var e=Object(a.useState)(""),t=Object(m.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(0),o=Object(m.a)(l,2),s=(o[0],o[1]),i=Object(a.useState)(0),f=Object(m.a)(i,2),d=f[0],p=f[1],g=Object(a.useState)(!0),j=Object(m.a)(g,2),O=j[0],w=j[1],S=Object(a.useState)("saved"),N=Object(m.a)(S,2),y=N[0],k=N[1],D=Object(a.useState)(2),x=Object(m.a)(D,2),M=x[0],C=x[1],P=Object(a.useState)("-1"),H=Object(m.a)(P,2),L=H[0],A=H[1],F=Object(a.useRef)(null),z=Object(a.useState)(0),T=Object(m.a)(z,2),B=T[0],J=T[1],U=Object(u.g)(),G=Object(u.h)().nid;function K(e){if("failed"===y||"unsaved"===y||"saving"===y)return e.preventDefault(),e.returnValue="Draft unsaved"}function R(){if("unsaved"===y)if(k("saving"),"-1"===L){var e=new FormData;e.append("token",b()),e.append("body",n),e.append("state",M),fetch(v+"/post",{method:"POST",body:e}).then((function(e){return e.json()})).catch((function(e){k("failed"),console.error("Post error: ",e)})).then((function(e){A(e.nid.toString()),k("saved")}))}else{var t=new FormData;t.append("nid",L),t.append("body",n),t.append("state",M),fetch(v+"/update",{method:"POST",body:t}).then((function(e){return e.json()})).catch((function(e){k("failed"),console.error("Update error: ",e)})).then((function(e){k("saved")}))}}function V(e){e.preventDefault(),c(e.target.value),k("unsaved")}function Y(e){c(e),k("unsaved")}function q(e){9===e.keyCode&&(e.preventDefault(),c(n.substring(0,F.current.selectionStart)+"    "+n.substring(F.current.selectionEnd)),J(F.current.selectionStart))}return Object(a.useEffect)((function(){"-1"===G?(A(G),s(Date.now()/1e3),p(Date.now()/1e3),c(""),w(!1)):(A(G),fetch(v+"/get?nid="+G+"&token="+b()).then((function(e){return e.json()})).then((function(e){console.log(e),e.success?(s(e.content[0]),p(e.content[1]),c(e.content[2]),C(e.content[3]),w(!1)):(C(e.error),w(!1))})))}),[G]),Object(a.useEffect)((function(){var e=setInterval(R,1e3);return function(){clearInterval(e)}})),Object(a.useEffect)((function(){return window.addEventListener("beforeunload",K),function(){window.removeEventListener("beforeunload",K)}})),Object(a.useEffect)((function(){null!=F.current&&(F.current.selectionStart=B+4,F.current.selectionEnd=B+4)}),[B]),O?r.a.createElement("div",{className:"loading"}," \u262a "):r.a.createElement("div",{className:"editor"},r.a.createElement("div",{className:"date"},"| ",r.a.createElement("span",null," ","-1"===L?"new":E(L,6)," "),"| ",r.a.createElement("span",null," ",h(d)," "),"| ",r.a.createElement("span",{onClick:function(e){e.preventDefault(),C((M+1)%3),k("unsaved")},className:"state-button"}," ",function(e){return 0===e?"raw":1===e?"view":2===e?"ace":"error"}(M)," "),"| ",r.a.createElement("span",{onClick:function(e){if(e.preventDefault(),window.confirm("Are you sure to delete?")){var t=new FormData;t.append("nid",L),t.append("token",b()),fetch(v+"/delete",{method:"POST",body:t}).then((function(e){return e.json()})).then((function(e){e.success?U.push("/"):alert(e.error)}))}},className:"delete-button"}," delete "),"| ",r.a.createElement("span",null," ",function(e){return"failed"===e?r.a.createElement("span",{style:{color:"red"}}," failed "):"saved"===e?r.a.createElement("span",{style:{color:"green"}}," saved "):e}(y)," ")," |"),function(e){return 0===e?r.a.createElement("textarea",{ref:F,onKeyDown:q,onChange:V,value:n,style:{height:window.innerHeight-200}}):1===e?r.a.createElement(_,{className:"markdown",source:n}):2===e?r.a.createElement(I.a,{mode:"markdown",theme:"textmate",name:"editor",value:n,onChange:Y,height:window.innerHeight-200,width:"100%",showGutter:!0,showPrintMargin:!1,highlightActiveLine:!0,placeholder:"",fontSize:16,setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!1,tabSize:2}}):e}(M),r.a.createElement(u.a,{message:"Draft unsaved, are you sure to leave?",when:"failed"===y||"unsaved"===y||"saving"===y}))};var B=function(){var e=Object(u.g)(),t=Object(a.useState)(""),n=Object(m.a)(t,2),c=n[0],l=n[1];return r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),""!==c&&(e.push("/search/"+c),l(""))}},r.a.createElement("input",{type:"text",value:c,placeholder:"Search",onChange:function(e){l(e.target.value)}}))};var J=function(){var e=Object(u.h)().keyword,t=Object(a.useState)([]),n=Object(m.a)(t,2),c=n[0],l=n[1];return Object(a.useEffect)((function(){fetch(v+"/search?keyword="+e+"&token="+b()).then((function(e){return e.json()})).then((function(e){l(e)}))}),[e]),r.a.createElement("div",{className:"search-results"},r.a.createElement(g,{items:c}))};function U(){return r.a.createElement("div",{className:"no-match"},r.a.createElement("p",null," No match! "))}var G=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(o.a,null,r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"title"}," ",r.a.createElement(o.b,{to:"/"}," NoNSeNSe ")," "),r.a.createElement("div",{className:"new-button"}," ",r.a.createElement(o.b,{to:"/edit/-1"}," \u271b ")," "),r.a.createElement("div",{className:"login-button"}," ",r.a.createElement(o.b,{to:"/login"}," \u2756 ")," "),r.a.createElement("div",{className:"search-bar"}," ",r.a.createElement(B,null)," ")),r.a.createElement("div",{className:"content"},r.a.createElement("hr",{className:"fancy-line"}),r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/login"},r.a.createElement(O,null)),r.a.createElement(u.b,{exact:!0,path:"/"},r.a.createElement(j,null)),r.a.createElement(u.b,{path:"/search/:keyword"},r.a.createElement(J,null)),r.a.createElement(u.b,{path:"/edit/:nid"},r.a.createElement(T,null)),r.a.createElement(u.b,{path:"*"},r.a.createElement(U,null))),r.a.createElement("hr",{className:"fancy-line"})),r.a.createElement(i.a,{showUnder:160},r.a.createElement("span",{className:"up-arrow"}," \u2bad ")),r.a.createElement("div",{className:"footer"},"@ ",r.a.createElement("a",{href:"https://github.com/ashawkey"}," hawkey "))))};l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(G,null)),document.getElementById("root"))},62:function(e,t,n){e.exports=n(384)},67:function(e,t,n){},73:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){}},[[62,1,2]]]);
//# sourceMappingURL=main.8b929a26.chunk.js.map